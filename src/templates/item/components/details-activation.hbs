{{#if hasActivation}}
<fieldset>
{{!-- Type --}}
    <legend>{{localize "COSMERE.Item.Sheet.Activation.Title"}}</legend>

    <div class="form-group">
        <label>{{localize "COSMERE.Item.Sheet.Activation.Type"}}</label>
        <div class="form-fields">
            <select name="system.activation.type"
                {{#if (not editable)}}
                disabled
                {{/if}}
            >
                {{selectOptions typeSelectOptions selected=item.system.activation.type localize=true}}
            </select>
        </div>
    </div>

    {{#if hasActivationType}}

    {{!-- Cost --}}
    <div class="form-group">
        <label>{{localize "COSMERE.Item.Sheet.Activation.Cost"}}</label>
        <div class="form-fields">          
            {{#if (eq item.system.activation.cost.type "act")}}
            <input name="system.activation.cost.value"
                type="number"
                min="0"
                max="3"
                step="1"
                value="{{item.system.activation.cost.value}}"
                {{#if (not editable)}}
                readonly
                {{/if}}
            >
            {{/if}}
            <select name="system.activation.cost.type"
                {{#if (not editable)}}
                disabled
                {{/if}}
            >
                {{selectOptions costTypeSelectOptions selected=item.system.activation.cost.type localize=true}}
            </select>
        </div>
    </div>

    {{!-- Resources --}}

    {{!-- Consume --}}
    <div class="form-group consume">
        <label>{{localize "COSMERE.Item.Sheet.Activation.Consume"}}</label>
        <div class="form-fields-list">
            {{#each consume}}
            <div class="form-fields">
                <input name="system.activation.consume[{{@index}}].value"
                    type="number"
                    min="0"
                    step="1"
                    value="{{this.value}}"
                    {{#if (not ../editable)}}
                    readonly
                    {{/if}}
                >

                {{#if (eq this.type "resource")}}
                <select name="system.activation.consume[{{@index}}].resource"
                    {{#if (not ../editable)}}
                    disabled
                    {{/if}}
                >
                    {{selectOptions ../resourceSelectOptions selected=this.resource localize=true}}
                </select>
                {{/if}}

                {{!-- TODO: Consume type = item --}}

                <select name="system.activation.consume[{{@index}}].type"
                    {{#if (not ../editable)}}
                    disabled
                    {{/if}}
                >
                    {{selectOptions ../consumeTypeSelectOptions selected=this.type localize=true}}
                </select>
                
                <div class="extra">
                    {{#unless @last}}
                    <span class="icon faded"><i class="fa-solid fa-ampersand"></i></span>
                    {{else}}
                    <a class="icon active" data-action="add-consumption-option"><i class="fa-solid fa-plus"></i></a>
                    {{/unless}}
                </div>
            </div>
            {{else}}            
            <div class="form-fields">
                <select name="system.activation.consume[].type"
                    {{#if (not editable)}}
                    disabled
                    {{/if}}
                >
                    {{selectOptions consumeTypeSelectOptions selected="none" localize=true}}
                </select>
            </div>
            {{/each}}
        </div>
    </div>

    {{!-- Uses --}}
    <div class="form-group uses">
        <label>{{localize "COSMERE.Item.Sheet.Activation.Uses"}}</label>
        <div class="form-fields">
            {{#if hasUses}}
            <input name="system.activation.uses.value"
                type="number"
                min="0"
                step="1"
                value="{{item.system.activation.uses.value}}"
                {{#if (not editable)}}
                readonly
                {{/if}}
            >
            <span class="delim">/</span>
            <input name="system.activation.uses.max"
                type="number"
                min="1"
                step="1"
                value="{{item.system.activation.uses.max}}"
                {{#if (not editable)}}
                readonly
                {{/if}}
            >
            {{/if}}

            <select name="system.activation.uses.type"
                {{#if (not editable)}}
                disabled
                {{/if}}
            >
                {{selectOptions usesTypeSelectOptions selected=item.system.activation.uses.type localize=true}}
            </select>
        </div>        
    </div>

    {{!-- Uses recharge --}}
    {{#if hasUses}}
    <div class="form-group">
        <label>{{localize "COSMERE.Item.Sheet.Activation.Recharge"}}</label>
        <div class="form-fields">
            <select name="system.activation.uses.recharge"
                {{#if (not editable)}}
                disabled
                {{/if}}
            >
                {{selectOptions rechargeSelectOptions selected=item.system.activation.uses.recharge localize=true}}
            </select>
        </div>        
    </div>
    {{/if}}

    {{!-- Skill test --}}
    {{#if (eq item.system.activation.type "skill_test")}}
    <div class="form-group">
        <label>{{localize "GENERIC.Skill"}}</label>
        <div class="form-fields">
            <select name="system.activation.skill"
                {{#if (not editable)}}
                disabled
                {{/if}}
            >
                {{selectOptions skillSelectOptions selected=item.system.activation.skill localize=true}}
            </select>
        </div>
    </div>
    <div class="form-group">
        <label>{{localize "GENERIC.Attribute"}}</label>
        <div class="form-fields">
            {{#if hasSkill}}
            <select name="system.activation.attribute"
                {{#if (not editable)}}
                disabled
                {{/if}}
            >
                {{selectOptions attributeSelectOptions selected=item.system.activation.attribute localize=true}}
            </select>
            {{else}}
            <input
                type="text"
                value="â€”"
                readonly
            >
            {{/if}}
        </div>
    </div>
    <div class="form-group">
        <label>{{localize "COSMERE.Item.Sheet.Activation.AdditionalFormula"}}</label>
        <div class="form-fields">       
            <input name="system.activation.modifierFormula"
                type="text"
                value="{{item.system.activation.modifierFormula}}"
                {{#if (not editable)}}
                readonly
                {{/if}}
            >
        </div>        
    </div>
    <p class="hint">
        {{localize "COSMERE.Item.Sheet.Activation.AdditionalFormulaDescription"}}
    </p>
    <div class="form-group">
        <label>{{localize "DICE.Plot.RaiseTheStakes"}}</label>
        <div class="form-fields">
            <input type="checkbox" 
                name="system.activation.plotDie"
                {{#if item.system.activation.plotDie}}
                checked
                {{/if}}
                {{#if (not editable)}}
                disabled
                {{/if}}
            >
        </div>        
    </div>
    {{formGroup systemFields.activation.fields.opportunity 
        value=item.system.activation.opportunity 
        type="number"
        placeholder="20"
        localize=true
        class="field"
    }}
    {{formGroup systemFields.activation.fields.complication 
        value=item.system.activation.complication 
        type="number"
        placeholder="1"
        localize=true
    }}
    {{/if}}
    {{/if}}
</fieldset>
{{/if}}